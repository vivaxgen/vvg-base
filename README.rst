vivaxGEN Base Installation Utility
==================================

This repo contains the necessary helpers for system installation of most
vivaxGEN system packages.

Quick Overview
--------------

The objective of this vivaxGEN base utility is to be able to install a set of
software packages, including the binary dependencies, in any directory without
the needs to install any prerequisite software other than ``curl`` and ``bash``
shell, and to allow other users who can access the installation directory to
also use the software packages without cluttering their home directory.

A standalone micromamba is utilized to provide all necessary binary
dependencies.
The standalone micromamba binary will be downloaded and installed in the
installation directory, and all of its configuration and settings will be
stored in the installation directory as well.
There will be no files stored in the home directory of users, apart from the
download cache directory of micromamba in ~/.cache/ and some added lines in
~/.conda/environment (if the file already exists) of the user who executes the
installation script.
The cache and the added lines can be removed manually without affecting the
installed system.

The following is base structure of the directories generated by the
installation script, assuming that VVG_BASEDIR is the root/base directory of
the installation::

    VVG_BASEDIR/
                bin/
                    activate
                    micromamba
                opt/
                    umamba/
                    apptainer/
                envs/
                     vvg-base/
                etc/
                    bashrc -> ../vvg-base/etc/bashrc
                    bashrc.d

Information about each file/directory in the base structure is as follow:

    ``bin/activate``
        This is the main activation/source script, meaning it can be executed
        to spawn a new shell, or sourced in the current shell or inside a shell
        script).
        The script basically sets up some environment variables, and then calls

    ``bin/micromamba``
        This is the micromamba executable binary, specific for each system/
        architecture.

    ``opt/umamba/``
        This directory will contain any files related to micromamba, such as
        environment settings and all binary dependencies files.

    ``opt/apptainer/``
        This directory will containt any image files related for system run
        through apptainer/singularity.

    ``envs/``
        This directory will hold all systems pulled from github repository,
        including the vvg-base itself.

    ``etc/bashrc``
        This is the main source file, which is needed to be sourced first
        before using the installed software (``bin/activate`` sources this file
        automatically).

    ``etc/bashrc.d``
        This directory contains bash resource files to be sourced in an
        alphabetical order when ``etc/bashrc`` is being sourced.
        Software package's specific activation source file should be put inside
        this directory.

        The activation source file name should be prefixed with 2-digit and
        dash, as example the source file for vivaxGEN NGS-Pipeline is
        ``10-ngs-pipeline``.
        Other pipelines and software packages relying on vivaxGEN NGS-Pipeline
        should use number starting from ``50-``.
        Other global settings that can be modified by users should use number
        starting from ``90-``, eg. the snakemake job scheduler profile setting
        is ``99-snakemake-profiles``.


